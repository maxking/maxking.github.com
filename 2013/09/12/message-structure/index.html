<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Structure of Email | maxking's blog</title><meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="This week I was busy investigating which kind of email does MUAs accept and display nicely. Now wait! What does *kind of email* and *MUA* mean?
Emails that you use everyday are of various types, much more than you would have though before. There are emails which can remove styling depending on the mail client where you are viewing the email. The email clients are generally called as MUA(Mail User Agent).">
<meta name=generator content="Hugo 0.93.2">
<meta name=robots content="noindex, nofollow">
<link rel=stylesheet href=/ananke/css/main.min.css>
<meta property="og:title" content="Structure of Email">
<meta property="og:description" content="This week I was busy investigating which kind of email does MUAs accept and display nicely. Now wait! What does *kind of email* and *MUA* mean?
Emails that you use everyday are of various types, much more than you would have though before. There are emails which can remove styling depending on the mail client where you are viewing the email. The email clients are generally called as MUA(Mail User Agent).">
<meta property="og:type" content="article">
<meta property="og:url" content="https://asynchronous.in/2013/09/12/message-structure/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2013-09-12T00:00:00+00:00">
<meta property="article:modified_time" content="2013-09-12T00:00:00+00:00">
<meta itemprop=name content="Structure of Email">
<meta itemprop=description content="This week I was busy investigating which kind of email does MUAs accept and display nicely. Now wait! What does *kind of email* and *MUA* mean?
Emails that you use everyday are of various types, much more than you would have though before. There are emails which can remove styling depending on the mail client where you are viewing the email. The email clients are generally called as MUA(Mail User Agent)."><meta itemprop=datePublished content="2013-09-12T00:00:00+00:00">
<meta itemprop=dateModified content="2013-09-12T00:00:00+00:00">
<meta itemprop=wordCount content="379">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Structure of Email">
<meta name=twitter:description content="This week I was busy investigating which kind of email does MUAs accept and display nicely. Now wait! What does *kind of email* and *MUA* mean?
Emails that you use everyday are of various types, much more than you would have though before. There are emails which can remove styling depending on the mail client where you are viewing the email. The email clients are generally called as MUA(Mail User Agent).">
</head><body class="ma0 avenir bg-near-white">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
maxking's blog
</a>
<div class="flex-l items-center">
<div class=ananke-socials>
</div></div></div></nav></div></header><main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside><div id=sharing class="mt3 ananke-socials">
</div><h1 class="f1 athelas mt3 mb1">Structure of Email</h1><time class="f6 mv4 dib tracked" datetime=2013-09-12T00:00:00Z>September 12, 2013</time>
</header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l">
<p> This week I was busy investigating which kind of email does MUAs accept and
display nicely. Now wait! What does *kind of email* and *MUA* mean?</p><p>Emails that you use everyday are of various types, much more than you would
have though before. There are emails which can remove styling depending on the
mail client where you are viewing the email. The email clients are generally
called as MUA(Mail User Agent). Now as per decided before we were planning to
send out signed emails which had signature from both sender and mailman. The
structure of a normal `pgp-signed` message is:
<pre>
multipart/signed
    text/plain
    application/pgp-signature
</pre>But this structure as you can see can with-hold only one signature part,
ofcourse if you strictly follow
<a href=https://tools.ietf.org/html/rfc3156> rfc3156 </a>. So we tried to
deviate a bit from convention and tried out a few more structures like below:
<pre>
multipart/signed
    text/plain
    multipart/mixed
       application/pgp-signature
       application/pgp-signature
</pre>The above structure does not work with my MUA for the reason that my
MUA(<a href=http://www.djcbsoftware.nl/code/mu/mu4e.html>mu4e</a>) fails to
find any signature part inside the email as it gets an 'multipart/mixed' type
instead of 'application/pgp-signature'.
<pre>
multipart/alternative
    multipart/signed
       text/plain
       application/pgp-signature
    multipart/signed
       text/plain
       application/pgp-signature
</pre>This part was recognized well by my MUA but it got confused to display which
type. Usually 'multipart/alternative' emails are made so that MUA selects the
best suited type it supports and display that part, but here it gets confused as
technically both parts have same type(only different signatures). So it
displayed both the parts one-after-another.Bah.
<pre>
mutipart/signed
   text/plain
   application/pgp-signature
   application/pgp-signature
</pre>This was one of the types where I inserted an extra signature part in the
original message. My MUA was although able to show both signatures, I am trying
to test all the three types with various other MUAs and then finally decide.
</p><b>EDIT</b><br>
<p> Finally we came up with another idea which was according to rfc as
well got verified in some of the MUAs that we tried, it goes like following:</p><pre>
multipart/signed
    multipart/mixed
       multipart/signed
           text/plain
           application/pgp-signature
       text/plain
    application/pgp-signature
</pre><p> In the above structure we have a multipart/mixed part which is actually
produces by mailman as of now, but from now(if my code is merged to the main
trunk) on it will be further modified to created a multipart/signed message
where whole multipart/mixed part is faltened and signature is calculate over the
whole part.<p>
<ul class=pa0>
</ul><div class="mt6 instapaper_ignoref">
</div></div><aside class="w-30-l mt6-l">
</aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://asynchronous.in>
&copy; maxking's blog 2022
</a>
<div>
<div class=ananke-socials>
</div></div></div></footer></body></html>